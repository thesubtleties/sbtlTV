appId: com.sbtltv.app
productName: sbtlTV
copyright: Copyright © 2026 sbtl

directories:
  output: ../../release
  buildResources: assets

files:
  - dist/**/*
  - assets/**/*
  - "!**/*.ts"
  - "!**/tsconfig.json"

# Unpack native addons and their dylib/dll deps from the asar archive.
# Electron auto-unpacks .node files, but the co-located dylibs need
# explicit unpacking so @loader_path resolves to the same directory.
asarUnpack:
  - "**/*.node"
  - "**/*.dylib"
  - "**/*.dll"

extraResources:
  # Bundle the UI dist folder
  - from: ../ui/dist
    to: ui
    filter:
      - "**/*"

# Windows configuration
win:
  target:
    - target: nsis
      arch:
        - x64
    - target: portable
      arch:
        - x64
  icon: assets/sbtltv-logo-white.png
  extraResources:
    - from: mpv-bundle
      to: mpv
      filter:
        - "**/*"

nsis:
  oneClick: false
  allowToChangeInstallationDirectory: true
  license: ../../LICENSE
  artifactName: ${productName}-${version}-win-${arch}-setup.${ext}

portable:
  artifactName: ${productName}-${version}-win-${arch}-portable.${ext}

# macOS configuration (arm64 only — native mpv-texture addon, no bundled external mpv)
mac:
  target:
    - target: dmg
      arch:
        - arm64
    - target: zip
      arch:
        - arm64
  icon: assets/sbtltv-logo-white.png
  artifactName: ${productName}-${version}-mac-${arch}.${ext}
  category: public.app-category.entertainment

dmg:
  contents:
    - x: 130
      y: 220
    - x: 410
      y: 220
      type: link
      path: /Applications

# Linux configuration
linux:
  target:
    - target: AppImage
      arch:
        - x64
    - target: deb
      arch:
        - x64
  icon: assets/512x512.png
  category: AudioVideo
  artifactName: ${productName}-${version}-linux-${arch}.${ext}

appImage:
  license: ../../LICENSE

# GitHub releases for auto-update
publish:
  provider: github
  owner: thesubtleties
  repo: sbtlTV
  releaseType: release
